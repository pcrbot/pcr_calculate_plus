
# [PCR ClanBattle Calculator](https://github.com/watermellye/pcr_calculator_plus)

公主连结公会战合刀计算器 by [ellye](https://github.com/watermellye/) 

指令前缀：`尾刀计算`, `合刀`, `cal`。
<br>
直接发送该指令时，将向聊天框发送以下说明的图片版本。

## 说明

**请首先输入boss当前血量B，然后输入每一刀伤害D/T，最后输入期望返还时间E。**

| 参数名 | 参数含义   | 可接受的格式                                                                       |
| ------ | ---------- | -------------------------------------------------------------------------------- |
| B      | boss当前血量 | 1000 1000w 1000W 1000万 10000000 1500-500                                         |
| D      | 对boss造成的伤害 | 1000 1000w 1000W 1000万 10000000 1500-500                                      |
| T      | 打死boss后剩余时间 | 30 30s 30S 30秒 15+15                                                            |
| E      | 期望返还时间 | 30 30s 30S 30秒 15+15                                                              |

当无量纲时，≥1w被识别为伤害，(90, 1w)被识别为伤害且自动×1w，≤90被识别为秒数。
<br>
T相当于B+T的缩写。例如：输入 `cal 700 30s` 相当于 `cal 700 700+30s`。

| 参数列表 | 使用例（输入） | 使用例（输出） |
| --- | --- | --- |
| B | cal 1500 | boss血量=1500w<br>刀数 / 满补所需伤害<br>1刀 &nbsp;&nbsp;&nbsp; 64285715<br>2刀 &nbsp;&nbsp;&nbsp; 12162163<br>3刀 &nbsp;&nbsp;&nbsp; 6716418<br>4刀 &nbsp;&nbsp;&nbsp; 4639176 |
| B D | cal 400 700 | boss血量=400w<br>对boss伤害=700w<br>补偿59s<br>垫入2366667伤害可满补 |
| | cal 700 400 | boss血量=700w<br>对boss伤害=400w<br>若400w先出，后出刀需12857143伤害（高于boss血量）才能满补<br>若400w后出，先出刀需6066667伤害可满补 |
| B T | cal 700 30s | boss血量=700w<br>对boss伤害=700w余30s<br>使用了60s，返还50s<br>需返还61s以一穿二，还需垫入1166667伤害<br>垫入4550001伤害可满补 |
| B DT | cal 700 800+55s | boss血量=700w<br>对boss伤害=800w余55s<br>使用了35s，返还80s<br>垫入2200001伤害可满补 |
| B E | cal 700 30s | boss血量=700w<br>期望返还时间=30s<br>刀数 / 所需伤害<br>1刀 &nbsp;&nbsp;&nbsp; 7777778<br>2刀 &nbsp;&nbsp;&nbsp; 3684211<br>3刀 &nbsp;&nbsp;&nbsp; 2413794 |
| B D D | cal 700 500 600 | boss血量=700w<br>对boss伤害=500w \| 600w<br>若[5000000]先出，[6000000]后出，补偿80s<br>若[6000000]先出，[5000000]后出，补偿90s |
| B T D | cal 700 500 30s | boss血量=700w<br>对boss伤害=500w \| 700w余30s<br>若[5000000]先出，[7000000+30s]后出，补偿90s<br>若[7000000+30s]直出，不出[5000000]，补偿50s |
| B D E | cal 700 500 30s | boss血量=700w<br>对boss伤害=500w<br>期望返还时间=30s<br>若5000000后出，需先垫入2500001伤害<br>若5000000先出，需再接上2222223伤害 |
| B T E | cal 700 30s 55s | boss血量=700w<br>对boss伤害=700w余30s (返还50s)<br>期望返还时间=55s, 还需垫入466667伤害 |

补时计算公式：
<br>
`[补偿秒数e] = min(90, ⌈110 - (90-[剩余秒数t])/([造成伤害d]/[boss血量b])⌉)`

公式解释：
```
[90-t]==[你实际使用的秒数(设为y)]。
公式的内生逻辑在于，如果你对boss造成了[d/b(设为x)]倍于boss的伤害，
则认为你只需要[y/x]的时间即可对boss造成d的伤害，还能剩余[90-y/x] (=90-(90-t)/(d/b))秒
再额外奖励20s，再向上取整，即获得上述方程。
```
